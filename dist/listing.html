<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>View Listing</title>
    <!-- BootStrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="listing.css">
    <!-- script needed for map -->
    <script src="https://unpkg.com/leaflet@1.9.2/dist/leaflet.js" integrity="sha256-o9N1jGDZrf5tS+Ft4gbIK7mYMipq9lqpVJ91xHSyKhg=" crossorigin=""></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.2/dist/leaflet.css" integrity="sha256-sA+zWATbFveLLNqWO2gtiw3HL/lh1giY/Inf1BJ0z14=" crossorigin="" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <!-- end script needed for map -->
    <script type="text/javascript" src="./script.js"></script>
  </head>
  <body onload="getLocation()">

    <!--Sticky Top Nav Bar Section-->
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-light px-5">

      <!-- Navbar Logo -->
      <a class="navbar-brand" href="#">RoofBlanket</a>
      <!-- End Of Navbar Logo -->

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Nav Bar Content -->
      <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
        <!--Nav Links-->
        <ul class="navbar-nav">
          <!--Call User's Profile Name-->
          <li class="navbar-text mx-5">
            Hello, Wai Soon
          </li>
          <li class="nav-item active">
            <a class="nav-link" href="#">Profile</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Message</a>
          </li>
          <li class="nav-item" style="margin-right: 30px;">
            <a class="nav-link" href="#">Task List</a>
          </li>
          <li class="nav-item">
            <button type="button" class="btn btn-outline-primary" href="login.html">Login</button>
          </li>
        </ul>
        <!-- End Of Nav Links-->

      </div>
      <!-- End Of Nav Bar Content -->
    </nav>
    <!-- End Of Sticky Top Nav Bar Section -->


    <!-- Start Of Body Content-->
    <div class="body-container my-5">

      <!-- First Section -->
      <div class="container-fluid carousel_body mb-5">

        <!-- Start of Carousel -->
        <div id="slider" class="carousel slide" data-bs-ride="carousel">

          <div class="carousel-inner">
            
            <div class="carousel-item active">
              <img class="d-block w-100 h-100" src="Images/Homeless_1.jpg" alt="First slide">
            </div>
            
            <div class="carousel-item">
              <img class="d-block w-100 h-100" src="Images/Homeless_2.jpg" alt="Second slide">
            </div>
            
            <div class="carousel-item">
              <img class="d-block w-100 h-100" src="Images/Homeless_3.jpg" alt="Third slide">
            </div>
          </div>

          <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-bs-target="#slider" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only"></span>
          </a>

          <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-bs-target="#slider" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only"></span>
          </a>
        </div>
        <!-- End of Carousel -->
      </div>
    <!-- End Of First Section -->
    </div>

    <!-- Start of Second Section-->
    <div class="container-fluid">

      <!-- Update Last Seen Location Pop Up Box (Hidden By Default) -->
      <div class='update' id='update'>
        <h2 class="my-3 text-center">Update Last Seen Location</h2>

        <!-- Integrate Map API here -->
        <div class='my-5' id="mapUpdate">
          <label for="map" class="form-label">Update Location</label>
        </div>

        <!-- Custom Notes -->
        <div class="mb-4">
          <label for="notes" class="form-label">Custom Notes</label>
          <textarea class="form-control" id="notes" rows="5"></textarea>
        </div>

        <!-- Add Image  -->
        <div class="mb-2">
          <label for="upload" class="form-label">Upload Image</label><br>
          <!-- For Uploading Image -->
          <input id="upload" type="file" multiple="multiple" accept="image/jpeg, image/png, image/jpg">
          <br>
          <!-- Display Image Uploaded -->
          <output id="result">
        </div>

        <div class="text-center">
          <button class="btn btn-primary" type="submit" name="submit">Update</button>
          <button class="btn btn-primary" type="submit" name="cancel" onclick="closeUpdate()">Cancel</button>
        </div>
      </div>

      <!-- Section for Listing Content -->
      <div class="listing">
      
        <div class="row">
          <div class="col-12 col-lg-6">
            <h3>Jeff So</h3>
            <span>Last Seen Location</span>
          </div>

          <!-- Right Side Portion (Samritan PIC + Name, Helped, Send Message, Update Last Seen)-->
          <div class="col-12 col-lg-6">
            
            <!-- Start Of Card -->
            <div class="card mb-3" style="max-width: 540px;">
              <div class="row g-0">

                <div class="col-md-4">
                  <img src="Images/RkPorkhouse.jfif" class="img-fluid rounded-start" alt="...">
                </div>

                <div class="col-md-8">
                  <div class="card-body">
                    <div class="row">
                      <h5 class="card-title">Lim Ren Kee</h5>
                      <p class="card-text"><small class="text-muted">Helped 3 Persons</small></p>
                    </div>

                    <div class="row">
                      <button type="button" class="btn btn-primary">Send Message</button>
                    </div>

                    <div class="row">
                      <button type="button" class="btn btn-primary" onclick="openUpdate()">Update Last Seen</button>
                    </div>
                    
                  </div>
                  <!-- End of Card Body -->
                </div>
              </div>
            </div>
            <!-- End Of Card-->
          </div>
        </div>
        <!-- End Of Row for left right portions-->

        <!-- Start of Description and Paragraph-->
        <div class="listing-content">
          <h2 class="col-12 col-lg-12">Description</h2>
          <p class="col-12 col-lg-6">Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
        </div>

      </div>
      <!-- End Section for Listing Content -->

      <!-- Section for Map Listing-->
      
      <div class="listing-map">
        <!-- API Integration here-->
        <div id="mapListing"></div>
      </div>

      <div class="notes-content">
        <!-- Header -->
        <div class="row">
          <h2>Notes</h2>
        </div>
        
        <!-- First Two Notes -->
        <!-- First Note-->
        <div class="row mt-5">
          <!-- First Note-->
          <div class="card col-12 col-lg-6">
            <div class="card-body">
              <h5 class="card-title">Card title</h5>
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
          </div>

          <!-- Second Note-->
          <div class="card col-12 col-lg-6">
            <div class="card-body">
              <h5 class="card-title">Card title</h5>
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
          </div>
        </div>

        <div class="row mt-5">
          <!-- First Note-->
          <div class="card col-12 col-lg-6">
            <div class="card-body">
              <h5 class="card-title">Card title</h5>
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
          </div>

          <!-- Second Note-->
          <div class="card col-12 col-lg-6">
            <div class="card-body">
              <h5 class="card-title">Card title</h5>
              <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
            </div>
          </div>
        </div>

      </div>
      <!-- End of Notes-content -->


    </div>
    <!-- End Of Container Section-->


    <!-- Java BootStrap CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>

    <script src="./bundle.js"></script>

    <script>
      let update = document.getElementById('update')
      let main = document.getElementById('main')
  
      function openUpdate() {
        update.classList.add('show-release')
        main.classList.add('blur')
      }
      function closeUpdate() {
        update.classList.remove('show-release')
        main.classList.remove('blur')
      }

      document.querySelector("#upload").addEventListener("change", (e) => { 
      if (window.File && window.FileReader && window.FileList && window.Blob) {
        const files = e.target.files;
        const output = document.querySelector("#result");
        output.innerHTML = "";
        for (let i = 0; i < files.length; i++) {
          if (!files[i].type.match("image")) continue;
            const picReader = new FileReader();
            picReader.addEventListener("load", function (event) {
              const picFile = event.target;
              const div = document.createElement("div");
              div.innerHTML = `<img class="thumbnail mb-3" src="${picFile.result}" title="${picFile.name}"/>`;
              output.appendChild(div);
            });
            picReader.readAsDataURL(files[i]);
          }
      } else {
        alert("Your browser does not support File API");
      }
    });

    </script>
  </body>

  <style>
    .update{
      background-color: beige;
      border-radius: 5%;
      padding: 20px;
      position: absolute;
      visibility: hidden;
      width: 50%;
      left: 25%;
      z-index: 1;
    }
    .show-release {
      visibility: visible;
    }
    .blur {
      filter: blur(5px);
    }
    #result{
      padding: 10px 0;
      display:inline-flex;
    }
    .thumbnail {
      width: 100px;
      height: 100px;
      margin-right: 10px;
    }
  </style>
</html>